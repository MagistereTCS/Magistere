define(["media_videojs/video-lazy","local_magisterelib/videojs-resolution-switcher","local_magisterelib/videojs-markers"],function(a){function b(){e=[]}function c(a,b,c,d){e.push({src:a,type:b,label:c,res:d})}function d(b){var c;try{c=a(b,{plugins:{videoJsResolutionSwitcher:{"default":"high",dynamicLabel:1}}})}catch(d){}c&&(c.markers({markers:[],markerTip:{display:!0,text:function(a){return a.text}}}),e.length>1?c.updateSrc(e):c.src(e[0]),c.on("loadedmetadata",function(){for(var a=c.textTracks(),b=null,d=0;a.length>d;d++)if("chapters"===a[d].kind){b=a[d];break}b&&b.addEventListener("cuechange",function(){c.markers.removeAll();for(var a=[],d=0;d<b.cues.length;d++){var e=b.cues[d].startTime,f=b.cues[d].text;a.push({time:e,text:f})}c.markers.add(a)})}))}var e=[];return{clearSrc:b,addSrc:c,updateSrc:d}});