if (typeof __coverage__ === 'undefined') { __coverage__ = {}; }
if (!__coverage__['build/moodle-atto_media-button/moodle-atto_media-button.js']) {
   __coverage__['build/moodle-atto_media-button/moodle-atto_media-button.js'] = {"path":"build/moodle-atto_media-button/moodle-atto_media-button.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":36},"end":{"line":1,"column":55}}},"2":{"name":"(anonymous_2)","line":80,"loc":{"start":{"line":80,"column":17},"end":{"line":80,"column":28}}},"3":{"name":"(anonymous_3)","line":95,"loc":{"start":{"line":95,"column":22},"end":{"line":95,"column":33}}},"4":{"name":"(anonymous_4)","line":121,"loc":{"start":{"line":121,"column":25},"end":{"line":121,"column":36}}},"5":{"name":"(anonymous_5)","line":131,"loc":{"start":{"line":131,"column":59},"end":{"line":131,"column":71}}},"6":{"name":"(anonymous_6)","line":147,"loc":{"start":{"line":147,"column":25},"end":{"line":147,"column":42}}},"7":{"name":"(anonymous_7)","line":163,"loc":{"start":{"line":163,"column":15},"end":{"line":163,"column":27}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":192,"column":61}},"2":{"start":{"line":36,"column":0},"end":{"line":57,"column":18}},"3":{"start":{"line":59,"column":0},"end":{"line":189,"column":3}},"4":{"start":{"line":81,"column":8},"end":{"line":86,"column":9}},"5":{"start":{"line":82,"column":12},"end":{"line":85,"column":15}},"6":{"start":{"line":97,"column":8},"end":{"line":97,"column":65}},"7":{"start":{"line":98,"column":8},"end":{"line":100,"column":9}},"8":{"start":{"line":99,"column":12},"end":{"line":99,"column":19}},"9":{"start":{"line":102,"column":8},"end":{"line":106,"column":11}},"10":{"start":{"line":109,"column":8},"end":{"line":110,"column":24}},"11":{"start":{"line":122,"column":8},"end":{"line":122,"column":54}},"12":{"start":{"line":124,"column":8},"end":{"line":128,"column":12}},"13":{"start":{"line":130,"column":8},"end":{"line":130,"column":71}},"14":{"start":{"line":131,"column":8},"end":{"line":134,"column":17}},"15":{"start":{"line":132,"column":12},"end":{"line":132,"column":31}},"16":{"start":{"line":133,"column":12},"end":{"line":133,"column":85}},"17":{"start":{"line":136,"column":8},"end":{"line":136,"column":29}},"18":{"start":{"line":148,"column":8},"end":{"line":153,"column":9}},"19":{"start":{"line":149,"column":12},"end":{"line":150,"column":46}},"20":{"start":{"line":151,"column":12},"end":{"line":152,"column":47}},"21":{"start":{"line":164,"column":8},"end":{"line":164,"column":27}},"22":{"start":{"line":165,"column":8},"end":{"line":167,"column":18}},"23":{"start":{"line":169,"column":8},"end":{"line":172,"column":36}},"24":{"start":{"line":174,"column":8},"end":{"line":187,"column":9}},"25":{"start":{"line":175,"column":12},"end":{"line":175,"column":54}},"26":{"start":{"line":176,"column":12},"end":{"line":176,"column":31}},"27":{"start":{"line":178,"column":12},"end":{"line":183,"column":13}},"28":{"start":{"line":180,"column":14},"end":{"line":180,"column":45}},"29":{"start":{"line":182,"column":14},"end":{"line":182,"column":82}},"30":{"start":{"line":185,"column":12},"end":{"line":185,"column":54}},"31":{"start":{"line":186,"column":12},"end":{"line":186,"column":31}}},"branchMap":{"1":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":8},"end":{"line":81,"column":8}},{"start":{"line":81,"column":8},"end":{"line":81,"column":8}}]},"2":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":8},"end":{"line":98,"column":8}},{"start":{"line":98,"column":8},"end":{"line":98,"column":8}}]},"3":{"line":148,"type":"if","locations":[{"start":{"line":148,"column":8},"end":{"line":148,"column":8}},{"start":{"line":148,"column":8},"end":{"line":148,"column":8}}]},"4":{"line":174,"type":"if","locations":[{"start":{"line":174,"column":8},"end":{"line":174,"column":8}},{"start":{"line":174,"column":8},"end":{"line":174,"column":8}}]},"5":{"line":174,"type":"binary-expr","locations":[{"start":{"line":174,"column":12},"end":{"line":174,"column":22}},{"start":{"line":174,"column":26},"end":{"line":174,"column":37}}]},"6":{"line":178,"type":"if","locations":[{"start":{"line":178,"column":12},"end":{"line":178,"column":12}},{"start":{"line":178,"column":12},"end":{"line":178,"column":12}}]}},"code":["(function () { YUI.add('moodle-atto_media-button', function (Y, NAME) {","","// This file is part of Moodle - http://moodle.org/","//","// Moodle is free software: you can redistribute it and/or modify","// it under the terms of the GNU General Public License as published by","// the Free Software Foundation, either version 3 of the License, or","// (at your option) any later version.","//","// Moodle is distributed in the hope that it will be useful,","// but WITHOUT ANY WARRANTY; without even the implied warranty of","// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the","// GNU General Public License for more details.","//","// You should have received a copy of the GNU General Public License","// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.","","/*"," * @package    atto_media"," * @copyright  2013 Damyon Wiese  <damyon@moodle.com>"," * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later"," */","","/**"," * @module moodle-atto_media-button"," */","","/**"," * Atto media selection tool."," *"," * @namespace M.atto_media"," * @class Button"," * @extends M.editor_atto.EditorPlugin"," */","","var COMPONENTNAME = 'atto_media',","    CSS = {","        URLINPUT: 'atto_media_urlentry',","        NAMEINPUT: 'atto_media_nameentry'","    },","    SELECTORS = {","        URLINPUT: '.' + CSS.URLINPUT,","        NAMEINPUT: '.' + CSS.NAMEINPUT","    },","    TEMPLATE = '' +","        '<form class=\"atto_form\">' +","            '<label for=\"{{elementid}}_atto_media_urlentry\">{{get_string \"enterurl\" component}}</label>' +","            '<input class=\"fullwidth {{CSS.URLINPUT}}\" type=\"url\" id=\"{{elementid}}_atto_media_urlentry\" size=\"32\"/><br/>' +","            '<button class=\"openmediabrowser\" type=\"button\">{{get_string \"browserepositories\" component}}</button>' +","            '<label for=\"{{elementid}}_atto_media_nameentry\">{{get_string \"entername\" component}}</label>' +","            '<input class=\"fullwidth {{CSS.NAMEINPUT}}\" type=\"text\" id=\"{{elementid}}_atto_media_nameentry\"' +","                    'size=\"32\" required=\"true\"/>' +","            '<div class=\"mdl-align\">' +","                '<br/>' +","                '<button class=\"submit\" type=\"submit\">{{get_string \"createmedia\" component}}</button>' +","            '</div>' +","        '</form>';","","Y.namespace('M.atto_media').Button = Y.Base.create('button', Y.M.editor_atto.EditorPlugin, [], {","","    /**","     * A reference to the current selection at the time that the dialogue","     * was opened.","     *","     * @property _currentSelection","     * @type Range","     * @private","     */","    _currentSelection: null,","","    /**","     * A reference to the dialogue content.","     *","     * @property _content","     * @type Node","     * @private","     */","    _content: null,","","    initializer: function() {","        if (this.get('host').canShowFilepicker('media')) {","            this.addButton({","                icon: 'e/insert_edit_video',","                callback: this._displayDialogue","            });","        }","    },","","    /**","     * Display the media editing tool.","     *","     * @method _displayDialogue","     * @private","     */","    _displayDialogue: function() {","        // Store the current selection.","        this._currentSelection = this.get('host').getSelection();","        if (this._currentSelection === false) {","            return;","        }","","        var dialogue = this.getDialogue({","            headerContent: M.util.get_string('createmedia', COMPONENTNAME),","            focusAfterHide: true,","            focusOnShowSelector: SELECTORS.URLINPUT","        });","","        // Set the dialogue content, and then show the dialogue.","        dialogue.set('bodyContent', this._getDialogueContent())","                .show();","    },","","    /**","     * Return the dialogue content for the tool, attaching any required","     * events.","     *","     * @method _getDialogueContent","     * @return {Node} The content to place in the dialogue.","     * @private","     */","    _getDialogueContent: function() {","        var template = Y.Handlebars.compile(TEMPLATE);","","        this._content = Y.Node.create(template({","            component: COMPONENTNAME,","            elementid: this.get('host').get('elementid'),","            CSS: CSS","        }));","","        this._content.one('.submit').on('click', this._setMedia, this);","        this._content.one('.openmediabrowser').on('click', function(e) {","            e.preventDefault();","            this.get('host').showFilepicker('media', this._filepickerCallback, this);","        }, this);","","        return this._content;","    },","","    /**","     * Update the dialogue after an media was selected in the File Picker.","     *","     * @method _filepickerCallback","     * @param {object} params The parameters provided by the filepicker","     * containing information about the image.","     * @private","     */","    _filepickerCallback: function(params) {","        if (params.url !== '') {","            this._content.one(SELECTORS.URLINPUT)","                    .set('value', params.url);","            this._content.one(SELECTORS.NAMEINPUT)","                    .set('value', params.file);","        }","    },","","    /**","     * Update the media in the contenteditable.","     *","     * @method setMedia","     * @param {EventFacade} e","     * @private","     */","    _setMedia: function(e) {","        e.preventDefault();","        this.getDialogue({","            focusAfterHide: null","        }).hide();","","        var form = e.currentTarget.ancestor('.atto_form'),","            url = form.one(SELECTORS.URLINPUT).get('value'),","            name = form.one(SELECTORS.NAMEINPUT).get('value'),","            host = this.get('host');","","        if (url !== '' && name !== '') {","            host.setSelection(this._currentSelection);","            var mediahtml = '';","            ","            if(url.indexOf(\"[[[cr_\") === 0)","            {","              mediahtml = Y.Escape.html(url);","            }else{","              mediahtml = '<a href=\"' + Y.Escape.html(url) + '\">' + name + '</a>';","            }","","            host.insertContentAtFocusPoint(mediahtml);","            this.markUpdated();","        }","    }","});","","","}, '@VERSION@', {\"requires\": [\"moodle-editor_atto-plugin\"]});","","}());"]};
}
var __cov_rE9vzJ60_FO4xOugmxKTkg = __coverage__['build/moodle-atto_media-button/moodle-atto_media-button.js'];
__cov_rE9vzJ60_FO4xOugmxKTkg.s['1']++;YUI.add('moodle-atto_media-button',function(Y,NAME){__cov_rE9vzJ60_FO4xOugmxKTkg.f['1']++;__cov_rE9vzJ60_FO4xOugmxKTkg.s['2']++;var COMPONENTNAME='atto_media',CSS={URLINPUT:'atto_media_urlentry',NAMEINPUT:'atto_media_nameentry'},SELECTORS={URLINPUT:'.'+CSS.URLINPUT,NAMEINPUT:'.'+CSS.NAMEINPUT},TEMPLATE=''+'<form class="atto_form">'+'<label for="{{elementid}}_atto_media_urlentry">{{get_string "enterurl" component}}</label>'+'<input class="fullwidth {{CSS.URLINPUT}}" type="url" id="{{elementid}}_atto_media_urlentry" size="32"/><br/>'+'<button class="openmediabrowser" type="button">{{get_string "browserepositories" component}}</button>'+'<label for="{{elementid}}_atto_media_nameentry">{{get_string "entername" component}}</label>'+'<input class="fullwidth {{CSS.NAMEINPUT}}" type="text" id="{{elementid}}_atto_media_nameentry"'+'size="32" required="true"/>'+'<div class="mdl-align">'+'<br/>'+'<button class="submit" type="submit">{{get_string "createmedia" component}}</button>'+'</div>'+'</form>';__cov_rE9vzJ60_FO4xOugmxKTkg.s['3']++;Y.namespace('M.atto_media').Button=Y.Base.create('button',Y.M.editor_atto.EditorPlugin,[],{_currentSelection:null,_content:null,initializer:function(){__cov_rE9vzJ60_FO4xOugmxKTkg.f['2']++;__cov_rE9vzJ60_FO4xOugmxKTkg.s['4']++;if(this.get('host').canShowFilepicker('media')){__cov_rE9vzJ60_FO4xOugmxKTkg.b['1'][0]++;__cov_rE9vzJ60_FO4xOugmxKTkg.s['5']++;this.addButton({icon:'e/insert_edit_video',callback:this._displayDialogue});}else{__cov_rE9vzJ60_FO4xOugmxKTkg.b['1'][1]++;}},_displayDialogue:function(){__cov_rE9vzJ60_FO4xOugmxKTkg.f['3']++;__cov_rE9vzJ60_FO4xOugmxKTkg.s['6']++;this._currentSelection=this.get('host').getSelection();__cov_rE9vzJ60_FO4xOugmxKTkg.s['7']++;if(this._currentSelection===false){__cov_rE9vzJ60_FO4xOugmxKTkg.b['2'][0]++;__cov_rE9vzJ60_FO4xOugmxKTkg.s['8']++;return;}else{__cov_rE9vzJ60_FO4xOugmxKTkg.b['2'][1]++;}__cov_rE9vzJ60_FO4xOugmxKTkg.s['9']++;var dialogue=this.getDialogue({headerContent:M.util.get_string('createmedia',COMPONENTNAME),focusAfterHide:true,focusOnShowSelector:SELECTORS.URLINPUT});__cov_rE9vzJ60_FO4xOugmxKTkg.s['10']++;dialogue.set('bodyContent',this._getDialogueContent()).show();},_getDialogueContent:function(){__cov_rE9vzJ60_FO4xOugmxKTkg.f['4']++;__cov_rE9vzJ60_FO4xOugmxKTkg.s['11']++;var template=Y.Handlebars.compile(TEMPLATE);__cov_rE9vzJ60_FO4xOugmxKTkg.s['12']++;this._content=Y.Node.create(template({component:COMPONENTNAME,elementid:this.get('host').get('elementid'),CSS:CSS}));__cov_rE9vzJ60_FO4xOugmxKTkg.s['13']++;this._content.one('.submit').on('click',this._setMedia,this);__cov_rE9vzJ60_FO4xOugmxKTkg.s['14']++;this._content.one('.openmediabrowser').on('click',function(e){__cov_rE9vzJ60_FO4xOugmxKTkg.f['5']++;__cov_rE9vzJ60_FO4xOugmxKTkg.s['15']++;e.preventDefault();__cov_rE9vzJ60_FO4xOugmxKTkg.s['16']++;this.get('host').showFilepicker('media',this._filepickerCallback,this);},this);__cov_rE9vzJ60_FO4xOugmxKTkg.s['17']++;return this._content;},_filepickerCallback:function(params){__cov_rE9vzJ60_FO4xOugmxKTkg.f['6']++;__cov_rE9vzJ60_FO4xOugmxKTkg.s['18']++;if(params.url!==''){__cov_rE9vzJ60_FO4xOugmxKTkg.b['3'][0]++;__cov_rE9vzJ60_FO4xOugmxKTkg.s['19']++;this._content.one(SELECTORS.URLINPUT).set('value',params.url);__cov_rE9vzJ60_FO4xOugmxKTkg.s['20']++;this._content.one(SELECTORS.NAMEINPUT).set('value',params.file);}else{__cov_rE9vzJ60_FO4xOugmxKTkg.b['3'][1]++;}},_setMedia:function(e){__cov_rE9vzJ60_FO4xOugmxKTkg.f['7']++;__cov_rE9vzJ60_FO4xOugmxKTkg.s['21']++;e.preventDefault();__cov_rE9vzJ60_FO4xOugmxKTkg.s['22']++;this.getDialogue({focusAfterHide:null}).hide();__cov_rE9vzJ60_FO4xOugmxKTkg.s['23']++;var form=e.currentTarget.ancestor('.atto_form'),url=form.one(SELECTORS.URLINPUT).get('value'),name=form.one(SELECTORS.NAMEINPUT).get('value'),host=this.get('host');__cov_rE9vzJ60_FO4xOugmxKTkg.s['24']++;if((__cov_rE9vzJ60_FO4xOugmxKTkg.b['5'][0]++,url!=='')&&(__cov_rE9vzJ60_FO4xOugmxKTkg.b['5'][1]++,name!=='')){__cov_rE9vzJ60_FO4xOugmxKTkg.b['4'][0]++;__cov_rE9vzJ60_FO4xOugmxKTkg.s['25']++;host.setSelection(this._currentSelection);__cov_rE9vzJ60_FO4xOugmxKTkg.s['26']++;var mediahtml='';__cov_rE9vzJ60_FO4xOugmxKTkg.s['27']++;if(url.indexOf('[[[cr_')===0){__cov_rE9vzJ60_FO4xOugmxKTkg.b['6'][0]++;__cov_rE9vzJ60_FO4xOugmxKTkg.s['28']++;mediahtml=Y.Escape.html(url);}else{__cov_rE9vzJ60_FO4xOugmxKTkg.b['6'][1]++;__cov_rE9vzJ60_FO4xOugmxKTkg.s['29']++;mediahtml='<a href="'+Y.Escape.html(url)+'">'+name+'</a>';}__cov_rE9vzJ60_FO4xOugmxKTkg.s['30']++;host.insertContentAtFocusPoint(mediahtml);__cov_rE9vzJ60_FO4xOugmxKTkg.s['31']++;this.markUpdated();}else{__cov_rE9vzJ60_FO4xOugmxKTkg.b['4'][1]++;}}});},'@VERSION@',{'requires':['moodle-editor_atto-plugin']});
