define(["local_magisterelib/nestable","local_magisterelib/tooltipster","jqueryui"],function(){function a(){var a=null;$(".dd").nestable({maxDepth:3,handleClass:"dd-itemdiv",expandBtnHTML:"",collapseBtnHTML:"",group:1,onDragStart:function(b,c,d){var e=$(c).find(".dd-div").first(),f=e.offset(),g=e.width(),h=e.height();return!(d.left<f.left||d.left>f.left+g||d.top<f.top||d.top>f.top+h)&&void(a=c.parents("ol:first").parent("li").children(".dd-itemdiv:first"))}}),$(".ishidden").parents("div.dd-itemdiv").addClass("hideClass"),$(".dd").on("click",".hide",function(){$(this).hasClass("ishidden")?($(this).toggleClass("ishidden",!1),$(this).addClass("fa-eye"),$(this).removeClass("fa-eye-slash"),$(this).tooltipster("content",$("<span>Masquer l'activité</span>")),$(this).parents("div.dd-itemdiv").removeClass("hideClass")):($(this).toggleClass("ishidden",!0),$(this).removeClass("fa-eye"),$(this).addClass("fa-eye-slash"),$(this).tooltipster("content",$("<span>Afficher l'activité</span>")),$(this).parents("div.dd-itemdiv").addClass("hideClass"))}),$("#submit").on("click",function(a){var c=b($(".block_list_activities"));$("#treedata").val(JSON.stringify(c))});var c={maxWidth:620,position:"bottom-right",timer:3e3};c.content=$("<span>Masquer l'activité</span>"),$(".hide:not(.ishidden)").tooltipster(c),c.content=$("<span>Afficher l'activité</span>"),$(".ishidden").tooltipster(c),c.content=$("<span>Déplacer l'activité</span>"),$(".move").tooltipster(c)}function b(a){var b=[],c=[],d=function(a,d){var e=[],f=a.children("li");return f.each(function(){var a=$(this).data(),e=$(this).find(".hide:first").hasClass("ishidden");e&&c.push(a.id),a.parentid=d?d:null,a.id>0&&b.push(a.id)}),e},e={weight_ids:b,not_displayed_ids:c};return a.find("#dd>ol").each(function(){d($(this))}),e}return{init:function(){a()}}});