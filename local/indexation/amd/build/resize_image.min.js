define(["jquery","jqueryui","local_magisterelib/cropperjs"],function(){return{init:function(){function a(a){var b=$("#image");b.cropper("destroy"),b.attr("src",$(".filepicker-filename").find("a").attr("href")),b.cropper({dragMode:"move",aspectRatio:16/9,restore:!1,guides:!1,center:!1,highlight:!1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!1,ready:function(c){if(a){var d=b.cropper("getCanvasData").naturalWidth,e=b.cropper("getCanvasData").naturalHeight,f=d,g=9*f/16;e<g&&(g=e,f=16*g/9);var h=d-f,i=e-g;h+f>d&&(f=d-h),i+g>e&&(g=e-i);var j={x:h,y:i,width:f,height:g};b.cropper("setData",{x:j.x/2,y:j.y/2,width:j.width,height:j.height,scaleX:1,scaleY:1})}else{var j=JSON.parse($("input[name='img_old_datas']").val());$("input[name='img_old_datas']").val(""),b.cropper("setData",{x:j.x,y:j.y,width:j.width,height:j.height,scaleX:1,scaleY:1})}},crop:function(a){if(!$("input[name='img_old_datas']").val()){var b={x:a.detail.x,y:a.detail.y,width:a.detail.width,height:a.detail.height};$("input[name='img_datas']").val(JSON.stringify(b))}},zoom:function(a){1===a.detail.oldRatio&&a.preventDefault()}})}const b=document.querySelector(".filepicker-filename"),c={attributes:!1,childList:!0,subtree:!1};$(".filepicker-filename").find("a").attr("href")&&a(!1);const d=function(b,c){a(!0)},e=new MutationObserver(d);e.observe(b,c)}}});