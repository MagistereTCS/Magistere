define(["jquery"],function(){var a=function(a){var b=a.parent(),c=b.find("a:first"),d=c.find(".instancename"),e=d.text(),f=$("<input>").attr({type:"text",value:e,"class":"editingfield"});b.prepend(f),f.keyup(function(a){"Escape"!=a.key&&"Enter"!=a.key||f.blur()}),f.on("blur focusout",function(){var d=$(this).val();if(e==d)return b.prepend(a),b.prepend(c),void f.remove();var g=M.cfg.wwwroot+"/lib/ajax/service.php?sesskey="+M.cfg.sesskey+"&info=core_update_inplace_editable",h=$(this).parents("li.activity:first").attr("id");h=h.replace("module-","");var i=[{index:0,args:{component:"core_course",itemid:h,itemtype:"activityname",value:d},methodname:"core_update_inplace_editable"}];f.attr("disabled","disabled"),$.ajax(g,{method:"POST",data:JSON.stringify(i),success:function(d){var e=d[0].data.value;c.find(".instancename").text(e),b.prepend(a),b.prepend(c),f.remove()},error:function(a){var b=$("<span>").html('<i class="fas fa-exclamation-triangle"></i>Modification échouée');b.css("color","#F55"),b.insertAfter(f)}})}),f.select(),c.detach(),a.remove()},b=function(){$(".header-editing").on("click","img.editbutton",function(){a($(this))}),$(".modtype_resource").on("click","img.editbutton",function(){a($(this))})};return{init:b}});