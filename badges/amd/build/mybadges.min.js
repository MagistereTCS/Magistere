define(["jquery","jqueryui","local_magisterelib/jtable"],function(a){return{init:function(b,c){function d(){var b=50;a(".show-read-more").each(function(){var c=a(this).text();if(a.trim(c).length>b){var d=c.substring(0,b),e=c.substring(b,a.trim(c).length);a(this).empty().html(d),a(this).append(' <a href="javascript:void(0);" class="view-more">... Voir plus</a>'),a(this).append('<span class="more-description">'+e+"</span>")}}),a(".view-more").click(function(){a(this).siblings(".more-description").contents().unwrap().slideDown("slow"),a(this).remove()})}function e(b){a("#dialog_confirm").html("Souhaitez-vous réellement supprimer ce badge de votre profil ?\nCette opération est définitive."),a("#dialog_confirm").dialog({width:400,title:"Suppression de badge",draggable:"false",modal:!0,resizable:!1,closeOnEscape:!1,closeText:"Fermer",buttons:[{text:"Oui",id:"btValidate",click:function(){a(this).dialog("close"),b.currentTarget.form.submit()}},{text:"Non",id:"btCancel",click:function(){a(this).dialog("close")}}]})}a("#MyBadgesTable").jtable({title:"",paging:!1,selecting:!1,multiselect:!1,selectingCheckboxes:!1,sorting:!0,defaultSorting:"firstname ASC",jqueryuiTheme:!0,defaultDateFormat:"dd/mm/yy",gotoPageArea:"none",selectOnRowClick:!1,actions:{listAction:function(c,f){return a.Deferred(function(g){a.ajax({url:b+"?action=list&si="+f.jtStartIndex+"&ps="+f.jtPageSize+"&so="+f.jtSorting,type:"POST",dataType:"json",data:c,success:function(b){g.resolve(b),d(),a(".delete-badge-btn").on("click",function(a){a.preventDefault(),e(a)})},error:function(){g.reject()}})})}},fields:{id:{title:"id",key:!0,width:"0%",create:!1,edit:!1,list:!1},name:{title:c.name,width:"29%",columnResizable:!1,listClass:"jt_name",create:!1,edit:!1,list:!0},description:{title:c.description,width:"35%",columnResizable:!1,listClass:"jt_description",create:!1,edit:!1,list:!0,sorting:!1},dateobtained:{title:c.dateobtained,width:"10%",columnResizable:!1,type:"date",listClass:"jt_dateobtained",create:!1,edit:!1,list:!0,sorting:!1},visibility:{title:c.visibility,width:"10%",columnResizable:!0,listClass:"jt_visibility",create:!1,edit:!1,list:!0,sorting:!1},actions:{title:c.actions,width:"16%",columnResizable:!1,listClass:"jt_actions",create:!1,edit:!1,list:!0,sorting:!1}}}),a("#MyBadgesTable").jtable("load")}}});